(()=>{"use strict";var e={424:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,"* {\n    box-sizing: border-box;\n}\nhtml {\n    height: 100%;\n}\n\nbody {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n    /* max-width: 1920px; */\n    min-width: 500px;\n    margin: auto;\n    font-family: sans-serif;\n    /* justify-content: space-between; */\n    padding: 0;\n    /* overflow: hidden; */\n}\n\n.header {\n    background-color: aqua;\n    max-height: 64px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 16px;\n    margin: 0;\n}\n\n.garage, \n.winners {\n    width: 100%;\n    /* max-width: 1920px; */\n    min-width: 500px;\n    /* flex-grow: 1; */\n    display: flex;\n    flex-direction: column;\n    background: #aaaaaa;\n    justify-content: space-between;\n    margin: 0;\n    padding: 0;\n    overflow: hidden;\n    overflow-y: auto;\n}\n",""]);const o=i},34:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".car-controls {\n    display: flex;\n    flex-direction: column;\n    width: 120px;\n    padding: 4px;\n    /* border: 1px solid black; */\n}\n\n.car-controls button {\n    width: 100%;\n}\n\n.track {\n    height: 100%;\n    flex-grow: 1;\n    /* border: 1px solid black; */\n    border-bottom: 4px dashed black;\n    position: relative;\n}\n\n.car-image {\n    height: 100%;\n    width: 100px;\n    overflow-wrap: normal;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-end;\n    align-items: center;\n    text-align: center;\n    position: absolute;\n    /* border: 1px solid green; */\n    padding-bottom: 4px;\n}\n\n.car-image p {\n    font-size: 14px;\n}\n\n.flag {\n    font-size: 36px;\n    position: absolute;\n    right: 64px;\n    bottom: 0;\n    z-index: 2;\n}\n",""]);const o=i},980:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".car-card {\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n}\n",""]);const o=i},864:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".car-name,\n.car-color {\n    margin: 0\n}\n\n.car-name {\n    size: 10;\n}",""]);const o=i},76:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".garage-creator,\n.garage-info,\n.garage-controls {\n    /* border: 1px solid blue; */\n}\n\n.garage-info,\n.garage-creator {\n    display: flex;\n    flex-direction: column;\n}\n\n.car-create button,\n.car-update button {\n    width: 100px;\n}\n\n.garage-info {\n    align-items: center;\n}\n\n.car-create,\n.car-update {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n}\n\n.start,\n.reset {\n    margin: 4px;\n}\n\n.garage-controls {\n    display: flex;\n    /* flex-direction: row; */\n    flex-direction: column;\n    padding: 8px;\n}\n\n.winner-message {\n    display: block;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n",""]);const o=i},184:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".h3 {\n    margin: 0;\n    padding: 0;\n    font-size: 18px;\n    font-weight: normal;\n    text-decoration: none;\n}\n\n.name {\n    font-size: 28px !important;\n    color: red;\n    margin: 0;\n    padding: 0 !important; \n}\n\n.page-selector {\n    padding-top: 4px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    align-items: center;\n}",""]);const o=i},476:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".h1 {\n    margin: 0;\n    padding: 8px 0;\n    font-size: 32px;\n    font-weight: 800;\n    text-decoration: none;\n}\n\n.buttons {\n    display: flex;\n    flex-direction: row;\n    /* height: 100%; */\n}\n\n.garage-header {\n    box-sizing: border-box;\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: flex-start;\n    /* border: 1px solid red; */\n}\n\n@media screen and (max-width: 640px) {\n    .garage-header {\n        flex-direction: column;\n        align-items: center;\n    }\n}\n\n.car-list {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n    overflow-y: auto;\n    padding: 0;\n    margin: 0;\n}\n",""]);const o=i},140:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".h1 {\n    margin: 0;\n    padding: 8px 0;\n    font-size: 36px;\n    font-weight: 600;\n    text-decoration: none;\n}\n\n.buttons {\n    display: flex;\n    flex-direction: row;\n}\n\n.garage-view,\n.winners-view {\n    margin-left: 4px;\n    margin-right: 4px;\n}\n",""]);const o=i},872:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".decrease,\n.increase {\n    margin-left: 4px;\n    margin-right: 4px;\n}\n\np {\n    font-size: 18px;\n    margin-block-start: 0;\n    margin-block-end: 0;\n}\n\n.cur-page {\n    margin-block-start: 0;\n    margin-block-end: 0;\n}",""]);const o=i},372:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".decrease,\n.increase {\n    margin-left: 4px;\n    margin-right: 4px;\n}\n\np {\n    font-size: 18px;\n    margin-block-start: 0;\n    margin-block-end: 0;\n}\n\n.cur-page {\n    margin-block-start: 0;\n    margin-block-end: 0;\n}",""]);const o=i},713:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".winners-info {\n    display: flex;\n    flex-direction: column;\n}\n\n.winners-info {\n    align-items: center;\n}\n",""]);const o=i},731:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".h3 {\n    margin: 0;\n    padding: 0;\n    font-size: 18px;\n    font-weight: normal;\n    text-decoration: none;\n}\n\n.name {\n    font-size: 28px !important;\n    color: red;\n    margin: 0;\n    padding: 0 !important; \n    /* padding-top: 0 !important;\n    padding-bottom: 8px !important; */\n}\n\n.page-winners-selector {\n    padding-top: 4px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    align-items: center;\n}",""]);const o=i},405:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".winners-table {\n    table-layout: fixed;\n    box-sizing: border-box;\n    width: 500px;\n    border-collapse: collapse;\n    border: 1px solid black;\n    text-align: center;\n}\n\n.winners-table button {\n    width: 100%;\n}\n\nthead th:nth-child(1) {\n    width: 8%;\n}\n\nthead th:nth-child(2) {\n    width: 25%;\n}\n\nthead th:nth-child(3) {\n    width: 35%;\n}\n\nthead th:nth-child(4) {\n    width: 12%;\n}\nthead th:nth-child(5) {\n    width: 20%;\n}\n\nth, td {\n    border: 1px solid black;\n}\n\nthead {\n    display: table-header-group;\n    vertical-align: middle;\n    border-color: inherit;\n}\n\ntr {\n    display: table-row;\n    vertical-align: inherit;\n    border-color: inherit;\n}\n\nth {\n    padding: 0;\n    margin: 0;\n}",""]);const o=i},963:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),i=t.n(r)()((function(e){return e[1]}));i.push([e.id,".h1 {\n    margin: 0;\n    padding: 8px 0;\n    font-size: 36px;\n    font-weight: 800;\n    text-decoration: none;\n}\n\n.buttons {\n    display: flex;\n    flex-direction: row;\n}\n\n.winners-header {\n    box-sizing: border-box;\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    align-items: flex-start;\n    /* border: 1px solid red; */\n}\n\n@media screen and (max-width: 640px) {\n    .garage-header {\n        flex-direction: column;\n        align-items: center;\n    }\n}\n\n.winners-list {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n    overflow-y: auto;\n    padding: 0;\n    margin: 0;\n    align-items: center;\n}\n",""]);const o=i},645:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t=e(n);return n[2]?"@media ".concat(n[2]," {").concat(t,"}"):t})).join("")},n.i=function(e,t,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(i[a]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&i[c[0]]||(t&&(c[2]?c[2]="".concat(t," and ").concat(c[2]):c[2]=t),n.push(c))}},n}},379:(e,n,t)=>{var r,i=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),o=[];function a(e){for(var n=-1,t=0;t<o.length;t++)if(o[t].identifier===e){n=t;break}return n}function s(e,n){for(var t={},r=[],i=0;i<e.length;i++){var s=e[i],c=n.base?s[0]+n.base:s[0],d=t[c]||0,l="".concat(c," ").concat(d);t[c]=d+1;var u=a(l),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(o[u].references++,o[u].updater(h)):o.push({identifier:l,updater:f(h,n),references:1}),r.push(l)}return r}function c(e){var n=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=t.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){n.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(n);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}return n}var d,l=(d=[],function(e,n){return d[e]=n,d.filter(Boolean).join("\n")});function u(e,n,t,r){var i=t?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(n,i);else{var o=document.createTextNode(i),a=e.childNodes;a[n]&&e.removeChild(a[n]),a.length?e.insertBefore(o,a[n]):e.appendChild(o)}}function h(e,n,t){var r=t.css,i=t.media,o=t.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,m=0;function f(e,n){var t,r,i;if(n.singleton){var o=m++;t=p||(p=c(n)),r=u.bind(null,t,o,!1),i=u.bind(null,t,o,!0)}else t=c(n),r=h.bind(null,t,n),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return r(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;r(e=n)}else i()}}e.exports=function(e,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var t=s(e=e||[],n);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<t.length;r++){var i=a(t[r]);o[i].references--}for(var c=s(e,n),d=0;d<t.length;d++){var l=a(t[d]);0===o[l].references&&(o[l].updater(),o.splice(l,1))}t=c}}}}},n={};function t(r){var i=n[r];if(void 0!==i)return i.exports;var o=n[r]={id:r,exports:{}};return e[r](o,o.exports,t),o.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0,(()=>{var e=t(379),n=t.n(e),r=t(424);n()(r.Z,{insert:"head",singleton:!1}),r.Z.locals;const i=class{constructor(e,n){this.container=document.createElement(e),this.container.className=n}render(){return this.container}};var o=t(34);function a(e){const n=e.getBoundingClientRect();return{x:n.left+n.width/2,y:n.top+n.height/2}}function s(e,n){const t=a(e),r=a(n);return Math.hypot(t.x-r.x,t.y-r.y)}function c(e,n,t){let r=0;const i={id:NaN};return i.id=window.requestAnimationFrame((function o(a){r||(r=a);const s=a-r,c=Math.round(s*(n/t));e.style.transform=`translateX(${Math.min(c,n)}px)`,c<n&&(i.id=window.requestAnimationFrame(o))})),i}function d(){let e="#";for(let n=0;n<6;n+=1)e+="0123456789ABCDEF".at(16*Math.random());return e}n()(o.Z,{insert:"head",singleton:!1}),o.Z.locals;const l=["Opel","Peugeot","Renault","Mersedes","Toyota","Nissan","Mazda","BMW","Ferrari","Fiat"],u=["GTS","CLK","Turbo","SW","Combi","TD","Max","HDi","CDi","SLX","4x4"];var h=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};function p(e){return`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="96" height="72" viewBox="0 0 96 72" xml:space="preserve">\n        <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1 1) scale(1 1)" >\n            <circle cx="70.735" cy="56.775" r="1.955" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: ${e}; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n            <circle cx="19.765" cy="56.775" r="1.955" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill:  ${e}; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n            <path d="M 75.479 36.045 l -7.987 -1.22 l -2.35 -2.574 c -5.599 -6.132 -13.571 -9.649 -21.874 -9.649 h -6.245 c -1.357 0 -2.696 0.107 -4.016 0.296 c -0.022 0.004 -0.044 0.006 -0.066 0.01 c -7.799 1.133 -14.802 5.468 -19.285 12.106 C 5.706 37.913 0 45.358 0 52.952 c 0 3.254 2.647 5.9 5.9 5.9 h 3.451 c 0.969 4.866 5.269 8.545 10.416 8.545 s 9.447 -3.679 10.416 -8.545 h 30.139 c 0.969 4.866 5.27 8.545 10.416 8.545 s 9.446 -3.679 10.415 -8.545 H 84.1 c 3.254 0 5.9 -2.646 5.9 -5.9 C 90 44.441 83.894 37.331 75.479 36.045 z M 43.269 26.602 c 7.065 0 13.848 2.949 18.676 8.094 H 39.464 l -3.267 -8.068 c 0.275 -0.009 0.55 -0.026 0.826 -0.026 H 43.269 z M 32.08 27.118 l 3.068 7.578 H 18.972 C 22.429 30.813 27.018 28.169 32.08 27.118 z M 19.767 63.397 c -3.652 0 -6.623 -2.971 -6.623 -6.622 c 0 -3.652 2.971 -6.623 6.623 -6.623 s 6.623 2.971 6.623 6.623 C 26.39 60.427 23.419 63.397 19.767 63.397 z M 70.738 63.397 c -3.652 0 -6.623 -2.971 -6.623 -6.622 c 0 -3.652 2.971 -6.623 6.623 -6.623 c 3.651 0 6.622 2.971 6.622 6.623 C 77.36 60.427 74.39 63.397 70.738 63.397 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: ${e}; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />\n        </g>\n    </svg>`}class m extends i{constructor(e,n,t){super(e,n),this.id=t.id,this.name=t.name,this.color=t.color,this.updateCar=document.createElement("button"),this.updateCar.className="update-car",this.updateCar.textContent="update car",this.removeCar=document.createElement("button"),this.removeCar.className="delete-car",this.removeCar.textContent="delete car",this.startCar=document.createElement("button"),this.startCar.className="start-car",this.startCar.textContent="start car",this.stopCar=document.createElement("button"),this.stopCar.className="stop-car",this.stopCar.textContent="stop car",this.stopCar.disabled=!0,this.track=document.createElement("div"),this.track.className="track",this.carImage=document.createElement("div"),this.carImage.className="car-image",this.carImage.id=`car-${this.id}`;let r="";r+=`<p>${this.name}</p><p>id=${this.id}</p>`,this.carImage.innerHTML=r+p(this.color),this.flag=document.createElement("p"),this.flag.className="flag",this.flag.innerText="🏁"}render(){const e=document.createElement("div");return e.className="car-controls",e.append(this.updateCar),e.append(this.removeCar),e.append(this.startCar),e.append(this.stopCar),this.container.append(e),this.track.append(this.carImage),this.track.append(this.flag),this.container.append(this.track),this.updateCar.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){const e=document.querySelector(".car-update");e.id=`id-${this.id}`;for(let n of e.childNodes)"car-name"===n.className&&(n.disabled=!1,n.value=this.name),"car-color"===n.className&&(n.disabled=!1,n.value=this.color),null!==n&&(n.disabled=!1);yield G()})))),this.removeCar.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){yield function(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${z}/${e}`,{method:"DELETE"});if(200===n.status)return U.totalCars-=1,0===U.totalCars?U.totalPages=1:U.totalPages=Math.floor((U.totalCars-1)/7)+1,U.curPage>U.totalPages&&(U.curPage-=1),yield n.json();throw new Error(`Ошибка в deleteCar! Status: ${n.status}`)}catch(e){return console.log("deleteCar error: "+e),"error deleteCar"}}))}(this.id),yield function(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${_}/${e}`,{method:"DELETE"});if(200===n.status)return console.log(`машина id=${e} удалена из победителей`),U.totalWinners-=1,0===U.totalWinners&&(U.totalWinPages=1),U.totalWinPages=Math.floor((U.totalWinners-1)/I)+1,yield n.json();throw new Error(`Ошибка в deleteWinner! Status: ${n.status}`)}catch(e){return console.log("deleteWinner error: "+e),"error deleteWinner"}}))}(this.id),yield G(),yield V()})))),this.startCar.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){const e=yield O(this.id);if("string"!=typeof e&&null!==e){this.startCar.disabled=!0;const n=Math.floor(s(this.carImage,this.flag))+32,t=c(this.carImage,n,e.distance/e.velocity);this.stopCar.disabled=!1,"string"==typeof(yield B(this.id))&&window.cancelAnimationFrame(t.id)}})))),this.stopCar.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){const e=yield R(this.id);if("string"!=typeof e&&null!==e){this.stopCar.disabled=!0,this.startCar.disabled=!1;const e=new m("div","car-card",{id:this.id,color:this.color,name:this.name});this.container.replaceWith(e.render())}})))),this.container}}const f=m;var g=t(980);n()(g.Z,{insert:"head",singleton:!1}),g.Z.locals;const v=class extends i{constructor(e,n){super(e,n)}render(){return U.cars.forEach((e=>{const n=new f("div","car-card",e);this.container.append(n.render())})),this.container}};var w=t(872);n()(w.Z,{insert:"head",singleton:!1}),w.Z.locals;var y=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};class x extends i{constructor(e,n){super(e,n),this.curPageIndex=U.curPage,this.pagesAmount=U.totalPages}render(){const e=document.createElement("button");e.className="decrease",e.textContent="<",this.container.append(e);const n=document.createElement("p");n.className="cur-page",n.innerText=`Page: ${this.curPageIndex} of ${this.pagesAmount}`,this.container.append(n);const t=document.createElement("button");return t.className="increase",t.textContent=">",this.container.append(t),1===this.curPageIndex?e.disabled=!0:e.disabled=!1,this.curPageIndex===this.pagesAmount?t.disabled=!0:t.disabled=!1,t.addEventListener("click",(()=>y(this,void 0,void 0,(function*(){U.curPage+=1,yield F(U.curPage,7);const e=new v("div","car-list");document.querySelector(".car-list").replaceWith(e.render()),document.querySelector(".total-cars").innerText=`Total Cars: ${U.totalCars}`;const n=new x("div","page-selector");document.querySelector(".page-selector").replaceWith(n.render())})))),e.addEventListener("click",(()=>y(this,void 0,void 0,(function*(){U.curPage-=1,yield F(U.curPage,7);const e=new v("div","car-list");document.querySelector(".car-list").replaceWith(e.render()),document.querySelector(".total-cars").innerText=`Total Cars: ${U.totalCars}`;const n=new x("div","page-selector");document.querySelector(".page-selector").replaceWith(n.render())})))),this.container}}const b=x;var C=t(405);n()(C.Z,{insert:"head",singleton:!1}),C.Z.locals;var E=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};const $=class extends i{constructor(e,n){super(e,n),this.sortId=document.createElement("button"),this.sortId.className="sort-id",this.sortId.textContent="id",this.sortCar=document.createElement("button"),this.sortCar.className="sort-car",this.sortCar.textContent="Car",this.sortName=document.createElement("button"),this.sortName.className="sort-name",this.sortName.textContent="Name",this.sortWins=document.createElement("button"),this.sortWins.className="sort-wins",this.sortWins.textContent="Wins",this.sortTime=document.createElement("button"),this.sortTime.className="sort-time",this.sortTime.textContent="Best Time"}render(){this.container.innerHTML="";const e=document.createElement("table");e.className="winners-table";const n=document.createElement("thead");n.className="winners-table-head",e.append(n);const t=document.createElement("tr"),r=document.createElement("th");r.appendChild(this.sortId),t.appendChild(r);const i=document.createElement("th");i.appendChild(this.sortCar),t.appendChild(i);const o=document.createElement("th");o.appendChild(this.sortName),t.appendChild(o);const a=document.createElement("th");a.appendChild(this.sortWins),t.appendChild(a);const s=document.createElement("th");s.appendChild(this.sortTime),t.appendChild(s),n.appendChild(t),e.appendChild(n);const c=document.createElement("tbody");return U.winners.forEach((e=>E(this,void 0,void 0,(function*(){const n=yield function(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${z}/${e}`,{method:"GET"});if(200===n.status)return yield n.json();throw new Error(`Ошибка в getCar! Status: ${n.status}`)}catch(e){return console.log("error getCar такая: "+e),"error 404"}}))}(e.id),t=document.createElement("tr");t.innerHTML=`<td>${e.id}</td>\n                            <td>${p(n.color)}</td>\n                            <td>${n.name}</td>\n                            <td>${e.wins}</td>\n                            <td>${e.time.toFixed(3)}</td>`,c.appendChild(t)})))),e.append(c),this.container.append(e),this.sortWins.addEventListener("click",(()=>E(this,void 0,void 0,(function*(){U.sort="wins","ASC"===U.order?U.order="DESC":U.order="ASC",V()})))),this.sortTime.addEventListener("click",(()=>E(this,void 0,void 0,(function*(){U.sort="time","ASC"===U.order?U.order="DESC":U.order="ASC",V()})))),this.sortId.addEventListener("click",(()=>E(this,void 0,void 0,(function*(){U.sort="id","ASC"===U.order?U.order="DESC":U.order="ASC",V()})))),this.container}};var N=t(372);n()(N.Z,{insert:"head",singleton:!1}),N.Z.locals;var T=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};class S extends i{constructor(e,n){super(e,n),this.curPageIndex=U.curWinPage,this.pagesAmount=U.totalWinPages}render(){const e=document.createElement("button");e.className="decrease",e.textContent="<",this.container.append(e);const n=document.createElement("p");n.className="cur-page",n.innerText=`Page: ${this.curPageIndex} of ${this.pagesAmount}`,this.container.append(n);const t=document.createElement("button");return t.className="increase",t.textContent=">",this.container.append(t),1===this.curPageIndex?e.disabled=!0:e.disabled=!1,this.curPageIndex===this.pagesAmount?t.disabled=!0:t.disabled=!1,t.addEventListener("click",(()=>T(this,void 0,void 0,(function*(){U.curWinPage+=1,U.winners=yield X(U.curWinPage,I,U.sort,U.order);const e=new $("div","winners-list");document.querySelector(".winners-list").replaceWith(e.render()),document.querySelector(".total-winners").innerText=`Total Winners: ${U.totalWinners}`;const n=new S("div","page-winners-selector");document.querySelector(".page-winners-selector").replaceWith(n.render())})))),e.addEventListener("click",(()=>T(this,void 0,void 0,(function*(){U.curWinPage-=1,U.winners=yield X(U.curWinPage,I,U.sort,U.order);const e=new $("div","winners-list");document.querySelector(".winners-list").replaceWith(e.render()),document.querySelector(".total-winners").innerText=`Total Winners: ${U.totalWinners}`;const n=new S("div","page-winners-selector");document.querySelector(".page-winners-selector").replaceWith(n.render())})))),this.container}}const k=S;var W=t(731);n()(W.Z,{insert:"head",singleton:!1}),W.Z.locals;const P=class extends i{constructor(e,n){super(e,n)}render(){this.container.innerHTML="";const e=document.createElement("h1");e.className="h1 name",e.innerText="Winners",this.container.append(e);const n=document.createElement("h3");n.className="h3 total-winners",n.innerText=`Total Winners: ${U.totalWinners}`,this.container.append(n);const t=new k("div","page-winners-selector");return this.container.append(t.render()),this.container}};var M=t(713);n()(M.Z,{insert:"head",singleton:!1}),M.Z.locals;const Z=class extends i{constructor(e,n){super(e,n)}render(){const e=new P("div","winners-info");return this.container.append(e.render()),this.container}};var A=t(963);n()(A.Z,{insert:"head",singleton:!1}),A.Z.locals;const j=class extends i{constructor(e,n){super(e,n)}render(){this.container.innerHTML="";const e=new Z("div","winners-header");this.container.append(e.render());const n=new $("div","winners-list");return this.container.append(n.render()),"winners"===U.pageView?this.container.style.display="flex":this.container.style.display="none",this.container}};var L=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};const I=10,q="http://127.0.0.1:3000",z=`${q}/garage`,H=`${q}/engine`,_=`${q}/winners`;function F(e,n=7){return L(this,void 0,void 0,(function*(){try{const t=yield fetch(`${z}?_page=${e}&_limit=${n}`,{method:"GET"});if(200===t.status)return U.cars=yield t.json(),U.totalCars=Number(t.headers.get("X-Total-Count")),0===U.totalCars?U.totalPages=1:U.totalPages=Math.floor((U.totalCars-1)/7)+1,U.numCars=U.cars.length,U.curPage=e,U.cars;throw new Error(`Ошибка в getCars! Status: ${t.status}`)}catch(e){return console.log("сработал catch в getCars. Ошибка такая: "+e),U.numCars=0,U.totalCars=0,U.totalPages=1,U.curPage=1,"error getCars"}}))}function D(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(z,{method:"POST",body:JSON.stringify({name:e.name,color:e.color}),headers:{"Content-Type":"application/json"}});if(201===n.status)return U.totalCars+=1,0===U.totalCars?U.totalPages=1:U.totalPages=Math.floor((U.totalCars-1)/7)+1,yield n.json();throw new Error(`Ошибка в createCar! Status: ${n.status}`)}catch(e){return console.log("createCar error: "+e),"error createCar"}}))}function G(){return L(this,void 0,void 0,(function*(){yield F(U.curPage,7);const e=new v("div","car-list");document.querySelector(".car-list").replaceWith(e.render()),document.querySelector(".total-cars").innerText=`Total Cars: ${U.totalCars}`;const n=new b("div","page-selector");document.querySelector(".page-selector").replaceWith(n.render())}))}function O(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${H}/?id=${e}&status=started`,{method:"PATCH"});if(200===n.status)return console.log(`машина id=${e} завелась`),yield n.json();throw new Error(`Ошибка в startEngine! Status: ${n.status}`)}catch(e){return console.log("startEngine error: "+e),`${e}`}}))}function R(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${H}/?id=${e}&status=stopped`,{method:"PATCH"});if(200===n.status)return console.log(`машина id=${e} остановлена`),yield n.json();throw new Error(`Ошибка в stopEngine! Status: ${n.status}`)}catch(e){return console.log("stopEngine error: "+e),`${e}`}}))}function B(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${H}/?id=${e}&status=drive`,{method:"PATCH"});if(200===n.status)return console.log(`машина id=${e} поехала`),yield n.json();throw 400===n.status?new Error('"id" should be any positive number, "status" should be "started", "stopped" or "drive"'):404===n.status?new Error('Engine parameters for car with such id was not found in the garage. Have you tried to set engine status to "started" before?'):429===n.status?new Error("Drive already in progress. You can't run drive for the same car twice while it's not stopped."):500===n.status?new Error(`Car id=${e} has been stopped suddenly. It's engine was broken down.`):new Error("Хз что за ошибка")}catch(e){return console.log("stopEngine error: "+e),`${e}`}}))}function X(e,n=10,t,r){return L(this,void 0,void 0,(function*(){try{const i=yield fetch(`${_}?_page=${e}&_limit=${n}${function(e,n){return e&&n?`&_sort=${e}&_order=${n}`:""}(t,r)}`);if(200===i.status)return U.winners=yield i.json(),U.totalWinners=Number(i.headers.get("X-Total-Count")),0===U.totalWinners?U.totalWinPages=1:U.totalWinPages=Math.floor((U.totalWinners-1)/I)+1,U.numWinners=U.winners.length,U.curWinPage=e,U.winners;throw new Error(`Ошибка в getWinners! Status: ${i.status}`)}catch(e){return console.log("сработал catch в getWinners. Ошибка такая: "+e),U.numWinners=0,U.totalWinners=0,U.totalWinPages=1,U.curWinPage=1,"error getWinners"}}))}function V(){return L(this,void 0,void 0,(function*(){U.winners=yield X(U.curWinPage,I,U.sort,U.order);const e=document.querySelector(".winners"),n=new j("div","winners");e.replaceWith(n.render())}))}class J{constructor(){J.pageView="garage",J.numCars=0,J.curPage=1,J.totalPages=1,J.sort="time",J.order="ASC"}static getData(){return e=this,n=void 0,r=function*(){const e=new J;J.cars=yield F(1,7),console.log(e),J.winners=yield X(1,I,"wins","ASC");const n=new j("div","win");console.log(n)},new((t=void 0)||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}));var e,n,t,r}}J.pageView="garage",J.numCars=0,J.cars=[],J.winners=[],J.time=[];const U=J;var K=t(140);n()(K.Z,{insert:"head",singleton:!1}),K.Z.locals;const Y=class extends i{constructor(e,n){super(e,n)}render(){const e=document.createElement("h1");e.className="h1",e.innerText="Async Race",this.container.append(e);const n=document.createElement("div");n.className="buttons";const t=document.createElement("button");t.className="garage-view",t.textContent="Garage",n.append(t);const r=document.createElement("button");return r.className="winners-view",r.textContent="Winners",n.append(r),"garage"===U.pageView?t.disabled=!0:r.disabled=!0,this.container.append(n),this.container.addEventListener("click",(e=>{const n=document.querySelector(".garage"),i=document.querySelector(".winners");"garage-view"===e.target.className?(n.style.display="flex",i.style.display="none",t.disabled=!0,r.disabled=!1,U.pageView="garage"):"winners-view"===e.target.className&&(n.style.display="none",i.style.display="flex",t.disabled=!1,r.disabled=!0,U.pageView="winners")})),this.container}};var Q=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};class ee extends f{constructor(e,n,t){super(e,n,t)}drive(){return Q(this,void 0,void 0,(function*(){const e=yield O(this.id);"string"!=typeof e&&null!==e?(this.startCar.disabled=!0,this.stopCar.disabled=!1,"string"==typeof(yield B(this.id))?(U.time.push(Number.MAX_SAFE_INTEGER),console.log(`машинка ${this.id} остановилась`)):U.time.push(e.distance/e.velocity)):(U.time.push(Number.MAX_SAFE_INTEGER),console.log("что-то не так с анимацией машины "+this.id))}))}stop(){return Q(this,void 0,void 0,(function*(){console.log("stop");const e=yield R(this.id);if("string"!=typeof e&&null!==e){this.stopCar.disabled=!0,this.startCar.disabled=!1;const e=new ee("div","car-card",{id:this.id,color:this.color,name:this.name});this.container.replaceWith(e.render())}}))}startEngine(){return Q(this,void 0,void 0,(function*(){return console.log("startEngine"),yield O(this.id)}))}stopEngine(){return Q(this,void 0,void 0,(function*(){return console.log("stopEngine"),yield R(this.id)}))}}const ne=ee;var te=t(864);n()(te.Z,{insert:"head",singleton:!1}),te.Z.locals;const re=class extends i{constructor(e,n,t){super(e,n),this.name="",this.color="#ffffff",this.buttonName=t}render(){const e=document.createElement("input");e.className="car-name",e.type="text",e.setAttribute("size","16"),e.placeholder="car name",this.container.append(e);const n=document.createElement("input");n.className="car-color",n.type="color",n.value=this.color,this.container.append(n);const t=document.createElement("button");return t.textContent=`${this.buttonName}`,this.container.append(t),"car-update"===this.container.className&&(e.disabled=!0,n.disabled=!0,t.disabled=!0),e.addEventListener("change",(()=>{this.name=e.value})),n.addEventListener("change",(()=>{this.color=n.value})),t.addEventListener("click",(()=>{return r=this,i=void 0,a=function*(){if("car-create"===this.container.className){if(""===this.name)return void alert("Enter car name");const t=yield D({name:this.name,color:this.color,id:0});this.name="",e.value="",this.color="#ffffff",n.value="#ffffff",null!==t&&(console.log("создана машина id = "+t.id+", color = "+t.color+", name = "+t.name),yield G())}else if("car-update"===this.container.className){this.name=e.value,this.color=n.value;const r=Number(this.container.id.slice(3)),i=yield function(e,n){return L(this,void 0,void 0,(function*(){try{const t=yield fetch(`${z}/${e}`,{method:"PUT",body:JSON.stringify({name:n.name,color:n.color}),headers:{"Content-Type":"application/json"}});if(200===t.status)return yield t.json();throw new Error(`Ошибка в updateCar! Status: ${t.status}`)}catch(e){return console.log("updateCar error: "+e),"error 404"}}))}(r,{name:this.name,color:this.color,id:0});this.name="",e.value="",this.color="#ffffff",n.value="#ffffff",e.disabled=!0,n.disabled=!0,t.disabled=!0,null!==i&&(console.log("апгрейчена машина id = "+i.id+", color = "+i.color+", name = "+i.name),yield G())}},new((o=void 0)||(o=Promise))((function(e,n){function t(e){try{c(a.next(e))}catch(e){n(e)}}function s(e){try{c(a.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(t,s)}c((a=a.apply(r,i||[])).next())}));var r,i,o,a})),this.container}};var ie=t(184);n()(ie.Z,{insert:"head",singleton:!1}),ie.Z.locals;const oe=class extends i{constructor(e,n){super(e,n)}render(){this.container.innerHTML="";const e=document.createElement("h1");e.className="h1 name",e.innerText="Garage",this.container.append(e);const n=document.createElement("h3");n.className="h3 total-cars",n.innerText=`Total Cars: ${U.totalCars}`,this.container.append(n);const t=new b("div","page-selector");return this.container.append(t.render()),this.container}};var ae=t(76);n()(ae.Z,{insert:"head",singleton:!1}),ae.Z.locals;var se=function(e,n,t,r){return new(t||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}))};const ce=class extends i{constructor(e,n){super(e,n)}render(){const e=document.createElement("div");e.className="garage-creator";const n=new re("div","car-create","create car");e.append(n.render());const t=new re("div","car-update","update car");e.append(t.render());const r=document.createElement("button");r.className="generate",r.textContent="Generate 100 random cars",e.append(r),this.container.append(e);const i=new oe("div","garage-info");this.container.append(i.render());const o=document.createElement("div");o.className="garage-controls";const a=document.createElement("button");a.className="start",a.textContent="Start race",o.append(a);const h=document.createElement("button");return h.className="reset",h.textContent="Reset",h.disabled=!0,o.append(h),this.container.append(o),r.addEventListener("click",(()=>se(this,void 0,void 0,(function*(){for(let e=0;e<100;e+=1){const e=`${l[Math.floor(Math.random()*l.length)]} ${u[Math.floor(Math.random()*u.length)]}`,n=d();yield D({name:e,color:n,id:0})}yield G()})))),a.addEventListener("click",(()=>se(this,void 0,void 0,(function*(){if(0===U.numCars)return;a.disabled=!0,h.disabled=!1;const e=[];U.cars.forEach((n=>{const t=new ne("div","car-card",n);e.push(t.drive())})),yield Promise.allSettled(e);let n=Number.MAX_SAFE_INTEGER,t=-1;for(let e=0;e<U.cars.length;e+=1)U.time[e]<n&&(n=U.time[e],t=U.cars[e].id);for(let e=0;e<U.cars.length;e+=1){const n=document.getElementById(`car-${U.cars[e].id}`),t=n.nextElementSibling,r=Math.floor(s(n,t))+32;U.time[e]<Number.MAX_SAFE_INTEGER&&c(n,r,U.time[e])}if(n!==Number.MAX_SAFE_INTEGER)if(function(e,n){setTimeout((()=>{const t=document.getElementById(`car-${n}`).parentNode,r=document.createElement("p");r.className="winner-message",r.innerHTML=`This car is a winner! Time is ${(e/1e3).toFixed(3)}`,t.appendChild(r),setTimeout((()=>t.removeChild(r)),4e3)}),e)}(n,t),console.log("выиграла машина id="+t+", время = "+n/1e3),U.time=[],yield function(e){return L(this,void 0,void 0,(function*(){try{if(!0===(yield fetch(`${_}/${e}`,{method:"GET"})).ok)return!0;throw!1}catch(e){return console.log("error getWinnerStatus такая: "+e),!1}}))}(t)){console.log("update winner");const e=yield function(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(`${_}/${e}`,{method:"GET"});if(200===n.status)return yield n.json();throw new Error(`Ошибка в getWinner! Status: ${n.status}`)}catch(e){return console.log("error getWinner такая: "+e),"error 404"}}))}(t);yield function(e,n){return L(this,void 0,void 0,(function*(){try{const t=yield fetch(`${_}/${e}`,{method:"PUT",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}});return yield t.json()}catch(e){return console.log("updateWinner error: "+e),"error updateWinner"}}))}(t,{id:t,wins:e.wins+1,time:e.time<n?e.time:n}),yield V()}else{const e=yield function(e){return L(this,void 0,void 0,(function*(){try{const n=yield fetch(_,{method:"POST",body:JSON.stringify({id:e.id,wins:e.wins,time:e.time}),headers:{"Content-Type":"application/json"}});if(201===n.status)return U.totalWinners+=1,U.totalWinPages=Math.floor((U.totalWinners-1)/I)+1,yield n.json();throw new Error(`Ошибка в createWinner! Status: ${n.status}`)}catch(e){return console.log("createWinner error: "+e),"error createWinner"}}))}({id:t,wins:1,time:n/1e3});console.log("новый победитель в таблицу: id="+e.id+", wins="+e.wins+", time="+e.time),yield V()}})))),h.addEventListener("click",(()=>{U.cars.forEach((e=>se(this,void 0,void 0,(function*(){yield R(e.id)})))),a.disabled=!1,h.disabled=!0,document.querySelectorAll(".car-card").forEach((e=>se(this,void 0,void 0,(function*(){e.querySelector(".update-car").disabled=!1,e.querySelector(".delete-car").disabled=!1,e.querySelector(".start-car").disabled=!1})))),G()})),this.container}};var de=t(476);n()(de.Z,{insert:"head",singleton:!1}),de.Z.locals;const le=class extends i{constructor(e,n){super(e,n)}render(){this.container.innerHTML="";const e=new ce("div","garage-header");this.container.append(e.render());const n=new v("div","car-list");return this.container.append(n.render()),"garage"===U.pageView?this.container.style.display="flex":this.container.style.display="none",this.container}};class ue{static render(){ue.container.innerHTML="";const e=new Y("nav","header");ue.container.append(e.render());const n=new le("div","garage");ue.container.append(n.render());const t=new j("div","winners");ue.container.append(t.render())}constructor(){}run(){return e=this,n=void 0,r=function*(){const e=new U;yield U.getData(),console.log(e),ue.render()},new((t=void 0)||(t=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(a,s)}c((r=r.apply(e,n||[])).next())}));var e,n,t,r}}ue.container=document.querySelector("body"),(new ue).run()})()})();