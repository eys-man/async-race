(()=>{"use strict";var e={424:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,"* {\n    box-sizing: border-box;\n}\nhtml {\n    height: 100%;\n}\n\nbody {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n    /* max-width: 1920px; */\n    min-width: 500px;\n    margin: auto;\n    font-family: sans-serif;\n    /* justify-content: space-between; */\n    padding: 0;\n    /* overflow: hidden; */\n}\n\n.header {\n    background-color: aqua;\n    max-height: 64px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 16px;\n    margin: 0;\n}\n\n.garage, \n.winners {\n    width: 100%;\n    /* max-width: 1920px; */\n    min-width: 500px;\n    /* flex-grow: 1; */\n    display: flex;\n    flex-direction: column;\n    background: #aaaaaa;\n    justify-content: space-between;\n    margin: 0;\n    padding: 0;\n    overflow: hidden;\n    overflow-y: auto;\n}\n",""]);const o=a},34:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".car-controls {\n    display: flex;\n    flex-direction: column;\n    width: 120px;\n    padding: 4px;\n    border: 1px solid black;\n}\n\n.car-controls button {\n    width: 100%;\n}\n\n.track {\n    height: 100%;\n    flex-grow: 1;\n    border: 1px solid black;\n    border-bottom: 4px dashed black;\n    position: relative;\n}\n\n.car-image {\n    height: 100%;\n    width: 100px;\n    overflow-wrap: normal;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-end;\n    align-items: center;\n    text-align: center;\n    position: absolute;\n    /* left: 8px; */\n    border: 1px solid green;\n    padding-bottom: 4px;\n}\n\n.car-image p {\n    font-size: 14px;\n}\n\n.flag {\n    font-size: 36px;\n    position: absolute;\n    right: 64px;\n    bottom: 0;\n    z-index: 2;\n}\n",""]);const o=a},980:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".car-card {\n    display: flex;\n    flex-direction: row;\n    width: 100%;\n}\n",""]);const o=a},864:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".car-name,\n.car-color {\n    margin: 0\n}\n\n.car-name {\n    size: 10;\n}",""]);const o=a},76:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".garage-creator,\n.garage-info,\n.garage-controls {\n    border: 1px solid blue;\n}\n\n.garage-info,\n.garage-creator {\n    display: flex;\n    flex-direction: column;\n}\n\n.car-create button,\n.car-update button {\n    width: 100px;\n}\n\n.garage-info {\n    align-items: center;\n}\n\n.car-create,\n.car-update {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n}\n\n.start,\n.reset {\n    margin: 4px;\n}\n\n.garage-controls {\n    display: flex;\n    /* flex-direction: row; */\n    flex-direction: column;\n    padding: 8px;\n}\n",""]);const o=a},184:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".h3 {\n    margin: 0;\n    padding: 0;\n    font-size: 18px;\n    font-weight: normal;\n    text-decoration: none;\n}\n\n.name {\n    font-size: 28px !important;\n    color: red;\n    margin: 0;\n    padding: 0 !important; \n    /* padding-top: 0 !important;\n    padding-bottom: 8px !important; */\n}\n\n.page-selector {\n    padding-top: 4px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-around;\n    align-items: center;\n}",""]);const o=a},476:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".h1 {\n    margin: 0;\n    padding: 8px 0;\n    font-size: 32px;\n    font-weight: 800;\n    text-decoration: none;\n}\n\n.buttons {\n    display: flex;\n    flex-direction: row;\n    /* height: 100%; */\n}\n\n.garage-header {\n    box-sizing: border-box;\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: flex-start;\n    border: 1px solid red;\n}\n\n@media screen and (max-width: 640px) {\n    .garage-header {\n        flex-direction: column;\n        align-items: center;\n    }\n}\n\n.car-list {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n    overflow-y: auto;\n    padding: 0;\n    margin: 0;\n}",""]);const o=a},140:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".h1 {\n    margin: 0;\n    padding: 8px 0;\n    font-size: 36px;\n    font-weight: 600;\n    text-decoration: none;\n}\n\n.buttons {\n    display: flex;\n    flex-direction: row;\n    /* height: 100%; */\n}\n\n.garage-view,\n.winners-view {\n    margin-left: 4px;\n    margin-right: 4px;\n}\n",""]);const o=a},872:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".decrease,\n.increase {\n    margin-left: 4px;\n    margin-right: 4px;\n}\n\np {\n    font-size: 18px;\n    margin-block-start: 0;\n    margin-block-end: 0;\n}\n\n.cur-page {\n    /* margin: 0; */\n    margin-block-start: 0;\n    margin-block-end: 0;\n    /* font-size: 18px; */\n}",""]);const o=a},963:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(645),a=t.n(r)()((function(e){return e[1]}));a.push([e.id,".h1 {\n    margin: 0;\n    padding: 8px 0;\n    font-size: 36px;\n    font-weight: 800;\n    text-decoration: none;\n}\n\n.buttons {\n    display: flex;\n    flex-direction: row;\n    /* height: 100%; */\n}\n",""]);const o=a},645:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t=e(n);return n[2]?"@media ".concat(n[2]," {").concat(t,"}"):t})).join("")},n.i=function(e,t,r){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(r)for(var o=0;o<this.length;o++){var i=this[o][0];null!=i&&(a[i]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&a[c[0]]||(t&&(c[2]?c[2]="".concat(t," and ").concat(c[2]):c[2]=t),n.push(c))}},n}},379:(e,n,t)=>{var r,a=function(){var e={};return function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}e[n]=t}return e[n]}}(),o=[];function i(e){for(var n=-1,t=0;t<o.length;t++)if(o[t].identifier===e){n=t;break}return n}function s(e,n){for(var t={},r=[],a=0;a<e.length;a++){var s=e[a],c=n.base?s[0]+n.base:s[0],d=t[c]||0,l="".concat(c," ").concat(d);t[c]=d+1;var u=i(l),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(o[u].references++,o[u].updater(h)):o.push({identifier:l,updater:m(h,n),references:1}),r.push(l)}return r}function c(e){var n=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=t.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){n.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(n);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}return n}var d,l=(d=[],function(e,n){return d[e]=n,d.filter(Boolean).join("\n")});function u(e,n,t,r){var a=t?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(n,a);else{var o=document.createTextNode(a),i=e.childNodes;i[n]&&e.removeChild(i[n]),i.length?e.insertBefore(o,i[n]):e.appendChild(o)}}function h(e,n,t){var r=t.css,a=t.media,o=t.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,f=0;function m(e,n){var t,r,a;if(n.singleton){var o=f++;t=p||(p=c(n)),r=u.bind(null,t,o,!1),a=u.bind(null,t,o,!0)}else t=c(n),r=h.bind(null,t,n),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)};return r(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;r(e=n)}else a()}}e.exports=function(e,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var t=s(e=e||[],n);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<t.length;r++){var a=i(t[r]);o[a].references--}for(var c=s(e,n),d=0;d<t.length;d++){var l=i(t[d]);0===o[l].references&&(o[l].updater(),o.splice(l,1))}t=c}}}}},n={};function t(r){var a=n[r];if(void 0!==a)return a.exports;var o=n[r]={id:r,exports:{}};return e[r](o,o.exports,t),o.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0,(()=>{var e=t(379),n=t.n(e),r=t(424);n()(r.Z,{insert:"head",singleton:!1}),r.Z.locals;const a=class{constructor(e,n){this.container=document.createElement(e),this.container.className=n}render(){return this.container}};var o=t(34);function i(e){const n=e.getBoundingClientRect();return{x:n.left+n.width/2,y:n.top+n.height/2}}function s(e,n){const t=i(e),r=i(n);return Math.hypot(t.x-r.x,t.y-r.y)}function c(e,n,t){let r=0;const a={id:NaN};return a.id=window.requestAnimationFrame((function o(i){r||(r=i);const s=i-r,c=Math.round(s*(n/t));e.style.transform=`translateX(${Math.min(c,n)}px)`,c<n&&(a.id=window.requestAnimationFrame(o))})),a}function d(){let e="#";for(let n=0;n<6;n+=1)e+="0123456789ABCDEF".at(16*Math.random());return e}n()(o.Z,{insert:"head",singleton:!1}),o.Z.locals;const l=["Opel","Peugeot","Renault","Mersedes","Toyota","Nissan","Mazda","BMW","Ferrari","Fiat"],u=["GTS","CLK","Turbo","SW","Combi","TD","Max","HDi","CDi","SLX","4x4"];var h=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((r=r.apply(e,n||[])).next())}))};class p extends a{constructor(e,n,t){super(e,n),this.id=t.id,this.name=t.name,this.color=t.color}render(){const e=document.createElement("div");e.className="car-controls";const n=document.createElement("button");n.className="update-car",n.textContent="update car",e.append(n);const t=document.createElement("button");t.className="delete-car",t.textContent="delete car",e.append(t);const r=document.createElement("button");r.className="start-car",r.textContent="start car",e.append(r);const a=document.createElement("button");a.className="stop-car",a.textContent="stop car",a.disabled=!0,e.append(a),this.container.append(e);const o=document.createElement("div");o.className="track";const i=document.createElement("div");i.className="car-image",i.id=`car-${this.id}`;let d="";var l;d+=`<p>${this.name}</p><p>id=${this.id}</p>`,i.innerHTML=d+`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="96" height="72" viewBox="0 0 96 72" xml:space="preserve">\n        <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1 1) scale(1 1)" >\n            <circle cx="70.735" cy="56.775" r="1.955" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: ${l=this.color}; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n            <circle cx="19.765" cy="56.775" r="1.955" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill:  ${l}; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n            <path d="M 75.479 36.045 l -7.987 -1.22 l -2.35 -2.574 c -5.599 -6.132 -13.571 -9.649 -21.874 -9.649 h -6.245 c -1.357 0 -2.696 0.107 -4.016 0.296 c -0.022 0.004 -0.044 0.006 -0.066 0.01 c -7.799 1.133 -14.802 5.468 -19.285 12.106 C 5.706 37.913 0 45.358 0 52.952 c 0 3.254 2.647 5.9 5.9 5.9 h 3.451 c 0.969 4.866 5.269 8.545 10.416 8.545 s 9.447 -3.679 10.416 -8.545 h 30.139 c 0.969 4.866 5.27 8.545 10.416 8.545 s 9.446 -3.679 10.415 -8.545 H 84.1 c 3.254 0 5.9 -2.646 5.9 -5.9 C 90 44.441 83.894 37.331 75.479 36.045 z M 43.269 26.602 c 7.065 0 13.848 2.949 18.676 8.094 H 39.464 l -3.267 -8.068 c 0.275 -0.009 0.55 -0.026 0.826 -0.026 H 43.269 z M 32.08 27.118 l 3.068 7.578 H 18.972 C 22.429 30.813 27.018 28.169 32.08 27.118 z M 19.767 63.397 c -3.652 0 -6.623 -2.971 -6.623 -6.622 c 0 -3.652 2.971 -6.623 6.623 -6.623 s 6.623 2.971 6.623 6.623 C 26.39 60.427 23.419 63.397 19.767 63.397 z M 70.738 63.397 c -3.652 0 -6.623 -2.971 -6.623 -6.622 c 0 -3.652 2.971 -6.623 6.623 -6.623 c 3.651 0 6.622 2.971 6.622 6.623 C 77.36 60.427 74.39 63.397 70.738 63.397 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: ${l}; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round" />\n        </g>\n    </svg>`,o.append(i);const u=document.createElement("p");return u.className="flag",u.innerText="🏁",o.append(u),this.container.append(o),n.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){const e=document.querySelector(".car-update");e.id=`id-${this.id}`;for(let n of e.childNodes)"car-name"===n.className&&(n.disabled=!1,n.value=this.name),"car-color"===n.className&&(n.disabled=!1,n.value=this.color),null!==n&&(n.disabled=!1);yield S()})))),t.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){yield function(e){return b(this,void 0,void 0,(function*(){try{const n=yield fetch(`${E}/${e}`,{method:"DELETE"});if(200===n.status)return j.totalCars-=1,0===j.totalCars?j.totalPages=1:j.totalPages=Math.floor((j.totalCars-1)/7)+1,j.curPage>j.totalPages&&(j.curPage-=1),yield n.json();throw new Error(`Ошибка в deleteCar! Status: ${n.status}`)}catch(e){return console.log("deleteCar error: "+e),"error deleteCar"}}))}(this.id),yield S()})))),r.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){const e=yield P(this.id);if("string"!=typeof e&&null!==e){r.disabled=!0;const n=Math.floor(s(i,u))+32,t=c(i,n,e.distance/e.velocity);a.disabled=!1,"string"!=typeof(yield M(this.id))||(console.log(`stop машина id=${this.id}!`),window.cancelAnimationFrame(t.id))}})))),a.addEventListener("click",(()=>h(this,void 0,void 0,(function*(){const e=yield T(this.id);if("string"!=typeof e&&null!==e){a.disabled=!0,r.disabled=!1;const e=new p("div","car-card",{id:this.id,color:this.color,name:this.name});this.container.replaceWith(e.render())}})))),this.container}}const f=p;var m=t(980);n()(m.Z,{insert:"head",singleton:!1}),m.Z.locals;const g=class extends a{constructor(e,n){super(e,n)}render(){return j.cars.forEach((e=>{const n=new f("div","car-card",e);this.container.append(n.render())})),this.container}};var v=t(872);n()(v.Z,{insert:"head",singleton:!1}),v.Z.locals;var y=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((r=r.apply(e,n||[])).next())}))};class x extends a{constructor(e,n){super(e,n),this.curPageIndex=j.curPage,this.pagesAmount=j.totalPages}render(){const e=document.createElement("button");e.className="decrease",e.textContent="<",this.container.append(e);const n=document.createElement("p");n.className="cur-page",n.innerText=`Page: ${this.curPageIndex} of ${this.pagesAmount}`,this.container.append(n);const t=document.createElement("button");return t.className="increase",t.textContent=">",this.container.append(t),1===this.curPageIndex?e.disabled=!0:e.disabled=!1,this.curPageIndex===this.pagesAmount?t.disabled=!0:t.disabled=!1,t.addEventListener("click",(()=>y(this,void 0,void 0,(function*(){j.curPage+=1,yield N(j.curPage,7);const e=new g("div","car-list");document.querySelector(".car-list").replaceWith(e.render()),document.querySelector(".total-cars").innerText=`Total Cars: ${j.totalCars}`;const n=new x("div","page-selector");document.querySelector(".page-selector").replaceWith(n.render())})))),e.addEventListener("click",(()=>y(this,void 0,void 0,(function*(){j.curPage-=1,yield N(j.curPage,7);const e=new g("div","car-list");document.querySelector(".car-list").replaceWith(e.render()),document.querySelector(".total-cars").innerText=`Total Cars: ${j.totalCars}`;const n=new x("div","page-selector");document.querySelector(".page-selector").replaceWith(n.render())})))),this.container}}const w=x;var b=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((r=r.apply(e,n||[])).next())}))};const C="http://127.0.0.1:3000",E=`${C}/garage`,k=`${C}/engine`;function N(e,n=7){return b(this,void 0,void 0,(function*(){try{const t=yield fetch(`${E}?_page=${e}&_limit=${n}`,{method:"GET"});if(200===t.status)return j.cars=yield t.json(),j.totalCars=Number(t.headers.get("X-Total-Count")),0===j.totalCars?j.totalPages=1:j.totalPages=Math.floor((j.totalCars-1)/7)+1,j.numCars=j.cars.length,j.curPage=e,j.cars;throw new Error(`Ошибка в getCars! Status: ${t.status}`)}catch(e){return console.log("сработал catch в getCars. Ошибка такая: "+e),j.numCars=0,j.totalCars=0,j.totalPages=1,j.curPage=1,"error getCars"}}))}function $(e){return b(this,void 0,void 0,(function*(){try{const n=yield fetch(E,{method:"POST",body:JSON.stringify({name:e.name,color:e.color}),headers:{"Content-Type":"application/json"}});if(201===n.status)return j.totalCars+=1,0===j.totalCars?j.totalPages=1:j.totalPages=Math.floor((j.totalCars-1)/7)+1,yield n.json();throw new Error(`Ошибка в createCar! Status: ${n.status}`)}catch(e){return console.log("createCar error: "+e),"error createCar"}}))}function S(){return b(this,void 0,void 0,(function*(){yield N(j.curPage,7);const e=new g("div","car-list");document.querySelector(".car-list").replaceWith(e.render()),document.querySelector(".total-cars").innerText=`Total Cars: ${j.totalCars}`;const n=new w("div","page-selector");document.querySelector(".page-selector").replaceWith(n.render())}))}function P(e){return b(this,void 0,void 0,(function*(){try{const n=yield fetch(`${k}/?id=${e}&status=started`,{method:"PATCH"});if(200===n.status)return console.log(`машина id=${e} завелась`),yield n.json();throw new Error(`Ошибка в startEngine! Status: ${n.status}`)}catch(e){return console.log("startEngine error: "+e),`${e}`}}))}function T(e){return b(this,void 0,void 0,(function*(){try{const n=yield fetch(`${k}/?id=${e}&status=stopped`,{method:"PATCH"});if(200===n.status)return console.log(`машина id=${e} остановлена`),yield n.json();throw new Error(`Ошибка в stopEngine! Status: ${n.status}`)}catch(e){return console.log("stopEngine error: "+e),`${e}`}}))}function M(e){return b(this,void 0,void 0,(function*(){try{const n=yield fetch(`${k}/?id=${e}&status=drive`,{method:"PATCH"});if(200===n.status)return console.log(`машина id=${e} поехала`),yield n.json();throw 400===n.status?new Error('"id" should be any positive number, "status" should be "started", "stopped" or "drive"'):404===n.status?new Error('Engine parameters for car with such id was not found in the garage. Have you tried to set engine status to "started" before?'):429===n.status?new Error("Drive already in progress. You can't run drive for the same car twice while it's not stopped."):500===n.status?new Error("Car has been stopped suddenly. It's engine was broken down."):new Error("Хз что за ошибка")}catch(e){return console.log("stopEngine error: "+e),`${e}`}}))}class Z{constructor(){Z.pageView="garage",Z.numCars=0,Z.curPage=1,Z.totalPages=1}static getData(){return e=this,n=void 0,r=function*(){Z.cars=yield N(1,7)},new((t=void 0)||(t=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((r=r.apply(e,n||[])).next())}));var e,n,t,r}}Z.pageView="garage",Z.numCars=0,Z.cars=[];const j=Z;var q=t(140);n()(q.Z,{insert:"head",singleton:!1}),q.Z.locals;const L=class extends a{constructor(e,n){super(e,n)}render(){const e=document.createElement("h1");e.className="h1",e.innerText="Async Race",this.container.append(e);const n=document.createElement("div");n.className="buttons";const t=document.createElement("button");t.className="garage-view",t.textContent="Garage",n.append(t);const r=document.createElement("button");return r.className="winners-view",r.textContent="Winners",n.append(r),"garage"===j.pageView?t.disabled=!0:r.disabled=!0,this.container.append(n),this.container.addEventListener("click",(e=>{const n=document.querySelector(".garage"),a=document.querySelector(".winners");"garage-view"===e.target.className?(n.style.display="flex",a.style.display="none",t.disabled=!0,r.disabled=!1,j.pageView="garage"):"winners-view"===e.target.className&&(n.style.display="none",a.style.display="flex",t.disabled=!1,r.disabled=!0,j.pageView="winners")})),this.container}};var z=t(963);n()(z.Z,{insert:"head",singleton:!1}),z.Z.locals;const A=class extends a{constructor(e,n){super(e,n)}render(){return this.container.innerHTML="",this.container.innerHTML="Winners","winners"===j.pageView?this.container.style.display="flex":this.container.style.display="none",this.container}};var H=t(864);n()(H.Z,{insert:"head",singleton:!1}),H.Z.locals;const W=class extends a{constructor(e,n,t){super(e,n),this.name="",this.color="#ffffff",this.buttonName=t}render(){const e=document.createElement("input");e.className="car-name",e.type="text",e.setAttribute("size","16"),e.placeholder="car name",this.container.append(e);const n=document.createElement("input");n.className="car-color",n.type="color",n.value=this.color,this.container.append(n);const t=document.createElement("button");return t.textContent=`${this.buttonName}`,this.container.append(t),"car-update"===this.container.className&&(e.disabled=!0,n.disabled=!0,t.disabled=!0),e.addEventListener("change",(()=>{this.name=e.value})),n.addEventListener("change",(()=>{this.color=n.value})),t.addEventListener("click",(()=>{return r=this,a=void 0,i=function*(){if("car-create"===this.container.className){if(""===this.name)return void alert("Enter car name");const t=yield $({name:this.name,color:this.color,id:0});this.name="",e.value="",this.color="#ffffff",n.value="#ffffff",null!==t&&(console.log("создана машина id = "+t.id+", color = "+t.color+", name = "+t.name),yield S())}else if("car-update"===this.container.className){this.name=e.value,this.color=n.value;const r=Number(this.container.id.slice(3)),a=yield function(e,n){return b(this,void 0,void 0,(function*(){try{const t=yield fetch(`${E}/${e}`,{method:"PUT",body:JSON.stringify({name:n.name,color:n.color}),headers:{"Content-Type":"application/json"}});if(200===t.status)return yield t.json();throw new Error(`Ошибка в updateCar! Status: ${t.status}`)}catch(e){return console.log("updateCar error: "+e),"error 404"}}))}(r,{name:this.name,color:this.color,id:0});this.name="",e.value="",this.color="#ffffff",n.value="#ffffff",e.disabled=!0,n.disabled=!0,t.disabled=!0,null!==a&&(console.log("апгрейчена машина id = "+a.id+", color = "+a.color+", name = "+a.name),yield S())}},new((o=void 0)||(o=Promise))((function(e,n){function t(e){try{c(i.next(e))}catch(e){n(e)}}function s(e){try{c(i.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(t,s)}c((i=i.apply(r,a||[])).next())}));var r,a,o,i})),this.container}};var O=t(184);n()(O.Z,{insert:"head",singleton:!1}),O.Z.locals;const F=class extends a{constructor(e,n){super(e,n)}render(){this.container.innerHTML="";const e=document.createElement("h1");e.className="h1 name",e.innerText="Garage",this.container.append(e);const n=document.createElement("h3");n.className="h3 total-cars",n.innerText=`Total Cars: ${j.totalCars}`,this.container.append(n);const t=new w("div","page-selector");return this.container.append(t.render()),this.container}};var D=t(76);n()(D.Z,{insert:"head",singleton:!1}),D.Z.locals;var I=function(e,n,t,r){return new(t||(t=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((r=r.apply(e,n||[])).next())}))};const B=class extends a{constructor(e,n){super(e,n)}render(){const e=document.createElement("div");e.className="garage-creator";const n=new W("div","car-create","create car");e.append(n.render());const t=new W("div","car-update","update car");e.append(t.render());const r=document.createElement("button");r.className="generate",r.textContent="Generate 100 random cars",e.append(r),this.container.append(e);const a=new F("div","garage-info");this.container.append(a.render());const o=document.createElement("div");o.className="garage-controls";const i=document.createElement("button");i.className="start",i.textContent="Start race",o.append(i);const h=document.createElement("button");return h.className="reset",h.textContent="Reset",h.disabled=!0,o.append(h),this.container.append(o),r.addEventListener("click",(()=>I(this,void 0,void 0,(function*(){for(let e=0;e<100;e+=1){const e=`${l[Math.floor(Math.random()*l.length)]} ${u[Math.floor(Math.random()*u.length)]}`,n=d();yield $({name:e,color:n,id:0})}yield S()})))),i.addEventListener("click",(()=>I(this,void 0,void 0,(function*(){if(0===j.numCars)return;i.disabled=!0,h.disabled=!1;const e=document.querySelectorAll(".car-card");let n=0;e.forEach((e=>I(this,void 0,void 0,(function*(){e.querySelector(".update-car").disabled=!0,e.querySelector(".delete-car").disabled=!0,e.querySelector(".start-car").disabled=!0;const t=e.querySelector(".car-image"),r=e.querySelector(".flag"),a=yield P(j.cars[n].id);if("string"!=typeof a&&null!==a){const e=c(t,Math.floor(s(t,r))+32,a.distance/a.velocity);"string"==typeof M(j.cars[n].id)&&window.cancelAnimationFrame(e.id)}n+=1}))))})))),h.addEventListener("click",(()=>{j.cars.forEach((e=>I(this,void 0,void 0,(function*(){yield T(e.id)})))),i.disabled=!1,h.disabled=!0,document.querySelectorAll(".car-card").forEach((e=>I(this,void 0,void 0,(function*(){e.querySelector(".update-car").disabled=!1,e.querySelector(".delete-car").disabled=!1,e.querySelector(".start-car").disabled=!1})))),S()})),this.container}};var V=t(476);n()(V.Z,{insert:"head",singleton:!1}),V.Z.locals;const R=class extends a{constructor(e,n){super(e,n)}render(){this.container.innerHTML="";const e=new B("div","garage-header");this.container.append(e.render());const n=new g("div","car-list");return this.container.append(n.render()),"garage"===j.pageView?this.container.style.display="flex":this.container.style.display="none",this.container}};class G{static render(){G.container.innerHTML="";const e=new L("nav","header");G.container.append(e.render());const n=new R("div","garage");G.container.append(n.render());const t=new A("div","winners");G.container.append(t.render())}constructor(){}run(){return e=this,n=void 0,r=function*(){yield N(1,7),G.render()},new((t=void 0)||(t=Promise))((function(a,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}c((r=r.apply(e,n||[])).next())}));var e,n,t,r}}G.container=document.querySelector("body"),(new G).run()})()})();